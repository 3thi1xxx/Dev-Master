# Axiom Trading Agent

## Agent Identity
- **Name**: AxiomTrader
- **Version**: 1.0.0-revival
- **Type**: Trading/Sniper
- **Safety Level**: QUARANTINED
- **Status**: DRY-RUN-ONLY

## Purpose
Revive and safely integrate legacy Axiom Solana trading/sniping bot with modern safety gates and relay system integration.

## Capabilities

### Core Functions
1. **Token Discovery** (`discoverTokens`)
   - Fetch trending tokens from multiple sources
   - Pulse monitoring for volume spikes
   - Multi-source data fusion
   - Always in dry-run mode for discovery

2. **Candidate Ranking** (`rankCandidates`)
   - Risk analysis using legacy thinker logic
   - Score-based token evaluation
   - Configurable risk tolerance
   - Safety-first ranking algorithms

3. **RPC Health Monitoring** (`checkRPCHealth`)
   - Multi-endpoint latency testing
   - Connection stability validation
   - Automatic failover recommendations
   - Performance benchmarking

4. **Trading Execution** (`snipe`)
   - **CRITICAL**: Requires triple approval (approvedBy + councilVerdict + chatdropId)
   - Slippage capped at 10%
   - Trade size capped at 1.0 SOL
   - Comprehensive pre-trade validation

## Safety Gates

### Primary Safety Controls
- **Default Dry-Run**: All operations default to `dryRun: true`
- **Triple Approval**: Live trades require:
  - `approvedBy`: Human operator ID
  - `councilVerdict`: Council approval hash
  - `chatdropId`: Signed chat drop reference
- **Amount Limits**: Maximum 1.0 SOL per trade
- **Slippage Limits**: Maximum 10% slippage
- **Timeout Protection**: 30-second operation timeouts

### Legacy Code Quarantine
- All legacy files isolated in `/legacy/axiom/`
- No direct network access from legacy code
- Adapter pattern wraps all legacy calls
- Module cache clearing for security

### Audit Trail
- All operations logged to `vault-log.ndjson`
- Session tracking with unique IDs
- Anchor-based log correlation
- Comprehensive error logging

## Relay Integration

### Input Schema
```javascript
{
  operation: "discoverTokens" | "rankCandidates" | "checkRPCHealth" | "snipe",
  params: {
    // Operation-specific parameters
    dryRun: true, // Always enforced
    limit?: number,
    maxCandidates?: number,
    riskTolerance?: "low" | "medium" | "high"
  },
  approval?: {
    approvedBy: string,
    councilVerdict: string,
    chatdropId: string
  }
}
```

### Output Schema
```javascript
{
  success: boolean,
  operationId: string,
  sessionId: string,
  data: any, // Operation-specific results
  warnings: string[],
  safetyGates: {
    dryRun: boolean,
    approvalRequired: boolean,
    limitsEnforced: boolean
  },
  anchor: {
    parents: string[],
    chatdrop_id?: string
  }
}
```

## Usage Examples

### Discovery Operation
```javascript
const adapter = new AxiomAdapter();
const tokens = await adapter.discoverTokens({ limit: 20 });
```

### Safe Trading (Dry Run)
```javascript
const result = await adapter.snipe(
  { address: "token_address", symbol: "TOKEN" },
  { 
    dryRun: true,
    maxAmount: 0.1,
    maxSlippage: 0.05
  }
);
```

### Live Trading (Requires Approval)
```javascript
const result = await adapter.snipe(
  { address: "token_address", symbol: "TOKEN" },
  { 
    dryRun: false,
    maxAmount: 0.5,
    maxSlippage: 0.03,
    approvedBy: "operator_123",
    councilVerdict: "council_hash_456",
    chatdropId: "chatdrop_789"
  }
);
```

## Error Handling

### Error Categories
1. **Configuration Errors**: Missing files, invalid setup
2. **Network Errors**: RPC failures, timeouts
3. **Validation Errors**: Invalid parameters, safety violations
4. **Execution Errors**: Trading failures, insufficient funds

### Error Response Format
```javascript
{
  error: true,
  type: "ValidationError" | "NetworkError" | "ConfigError" | "ExecutionError",
  message: string,
  operationId: string,
  recommendations: string[]
}
```

## Monitoring & Alerts

### Key Metrics
- Discovery success rate
- RPC endpoint health
- Error frequencies by type
- Safety gate activations
- Dry-run vs live operation ratios

### Alert Conditions
- Multiple safety gate violations
- Persistent RPC failures
- Unexpected legacy code errors
- Approval bypass attempts

## Deployment Requirements

### Prerequisites
- Node.js runtime
- Legacy Axiom files in `/legacy/axiom/`
- Proper directory structure
- Network access for RPC calls

### Pre-deployment Checklist
1. Run `cbsh/audit-axiom.sh` - Must pass
2. Execute `cbsh/run-axiom-dry.sh` - Verify functionality
3. Review vault logs for anomalies
4. Confirm safety gates are active
5. Test approval workflows

### Environment Variables
- `AXIOM_DRY_RUN=true` - Force dry-run mode
- `AXIOM_VERBOSE=true` - Enable detailed logging
- `NODE_ENV=development` - Development safety mode

## Legacy Code Map

### Scripts Directory (`/legacy/axiom/scripts/`)
- `solana-bot-main.js` - Main bot entry point
- `solana-bot-main.ts` - TypeScript variant
- `gen-wallet.js` - Wallet generation utilities
- `testWallet.cjs` - Wallet testing tools
- `verify-wallet-consistency.{js,cjs}` - Wallet validation

### Sniper Directory (`/legacy/axiom/sniper/`)
- `axiom-sniper.js` - Core sniping logic
- `axiom-latency-check.js` - Network latency tools
- `fetchPulse.js` - Market pulse monitoring
- `fetchTrending.js` - Trending token discovery
- `rpc-latency-test.js` - RPC performance testing
- `thinker.js` - Token analysis engine
- `watcher.js` - Market monitoring

## Maintenance

### Regular Tasks
- Weekly audit runs
- RPC endpoint health checks
- Log rotation and archival
- Legacy code security scans

### Updates
- Security patches to adapter
- RPC endpoint updates
- Risk parameter tuning
- Safety gate enhancements

## Compliance

### Risk Management
- All trades logged with full context
- Mandatory dry-run testing
- Human oversight for live trades
- Automated risk limit enforcement

### Audit Trail
- Immutable log entries
- Operation correlation via anchors
- Council approval tracking
- Error investigation capabilities

---

**Security Notice**: This agent handles financial operations. All changes require security review and council approval. Never bypass safety gates or approval mechanisms. 