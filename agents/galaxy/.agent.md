# Galaxy Brain Agent Specification

## Agent Identity
- **Name**: Galaxy Brain Orchestrator
- **Type**: Meta-Agent Oversight System  
- **Version**: 1.0.0
- **Trust Level**: HIGH (requires explicit approval)

## Capabilities

### Core Functions
- **Agent State Tracking**: Monitor health of multiple sub-agents
- **Self-Healing**: Automatic recovery from error states
- **Loop Detection**: Prevent infinite feedback loops
- **Git Hygiene**: Scan for large files and forbidden directories
- **Dashboard Rendering**: Real-time agent status visualization
- **Meta-Agent Oversight**: Coordinate multiple agent interactions

### Safety Features
- **Dry Run Mode**: Default safe execution without side effects
- **Approval Gates**: Requires `approved_by` and `chatdrop_id` for live operations
- **Audit Logging**: Full ProofLogger integration with Chad Lockdown Spine
- **Task Queuing**: Dangerous operations queued via QueueManager
- **Rollback Capability**: State restoration for failed operations

## Interface

### Initialization
```javascript
import { GalaxyBrainAdapter } from './agents/galaxy/GalaxyBrainAdapter.js';

const galaxy = new GalaxyBrainAdapter({
    dryRun: true,              // Safe by default
    approved_by: null,         // Required for live mode
    chatdrop_id: null,         // Required for live mode  
    vaultRoot: './chad-lockdown-spine'
});

await galaxy.initialize();
```

### Primary Methods
- `start(options)` - Begin orchestration (dry/live mode)
- `stop()` - Halt all operations safely
- `heartbeat()` - Check agent health
- `scanHygiene()` - Git repository health scan
- `selfHeal()` - Attempt agent recovery
- `getHealthStatus()` - Current system health
- `getAgentStates()` - Agent state snapshot

### CLI Access
- `cbsh/galaxy-run-dry.sh` - Safe execution wrapper
- `cbsh/galaxy-health.sh` - Health check diagnostics

## Trust Requirements

### Live Mode Prerequisites
1. **User Identification**: `approved_by` parameter must be set
2. **Session Tracking**: `chatdrop_id` parameter must be set  
3. **Lockdown Spine**: Chad Lockdown Spine infrastructure present
4. **Audit Trail**: ProofLogger and QueueManager functional

### Blocked Operations (unless approved)
- Git repository mutations (`git rm`, `.gitignore` modifications)
- File system writes outside logs directory
- Process execution of external commands
- Background daemon processes

### Audit Requirements
All operations logged to:
- **ProofLogger**: Cryptographic audit trail
- **PMAC Log**: `.pmac.log` with timestamped entries
- **Vault Log**: `vault-log.ndjson` with anchor parents
- **Console**: Real-time operation feedback

## Agent States

### Standard States
- `idle` - Ready for commands
- `working` - Processing tasks
- `error` - Requires intervention
- `stuck` - Automatic retry in progress
- `recovering` - Self-heal in progress

### Meta States  
- `healthy` - All systems operational
- `degraded` - Some functionality impaired
- `critical` - Immediate attention required

## Integration Points

### Chad Lockdown Spine
- **ProofLogger**: `chad-lockdown-spine/src/lib/ProofLogger.js`
- **QueueManager**: `chad-lockdown-spine/spine-backup/relay/lib/QueueManager.js`
- **Trust Infrastructure**: Approval gates and audit trails

### Original Orchestrator
- **Source**: `agents/galaxy/GalaxyBrainOrchestrator.js`
- **Wrapped By**: `GalaxyBrainAdapter.js` (trust-safe layer)
- **Archived Variants**: `legacy/galaxy/orchestrator-archive/`

## Configuration

### Environment Variables
- `CHAD_SIGNING_KEY` - Cryptographic signing key for ProofLogger
- `QUEUEMANAGER_STUB` - Enable queue operation simulation

### File System Layout
```
agents/galaxy/
├── GalaxyBrainAdapter.js      # Trust-safe wrapper
├── GalaxyBrainOrchestrator.js # Original implementation  
└── .agent.md                  # This specification

cbsh/
├── galaxy-run-dry.sh          # Safe execution script
└── galaxy-health.sh           # Health diagnostics

docs/galaxy/
├── MVP-checklist.md           # Original design checklist
└── galaxy-upgrades.md         # Advanced features roadmap

legacy/galaxy/
├── ARCHIVE_MANIFEST.md        # Version history
└── orchestrator-archive/      # SHA-tagged variants
```

## Operational Guidelines

### Development Usage
1. Always start with `cbsh/galaxy-health.sh` to verify system health
2. Use `cbsh/galaxy-run-dry.sh` for testing and demonstrations  
3. Review logs in `chad-lockdown-spine/logs/` after operations
4. Never bypass approval gates in production environments

### Production Usage
1. Obtain explicit user approval with `approved_by` and `chatdrop_id`
2. Verify health score ≥90% before live operations
3. Monitor audit trails continuously during execution
4. Maintain rollback capability for all state changes

---

**Security Notice**: Galaxy Brain has capabilities for git repository management and agent coordination. All live operations require explicit approval and full audit logging through Chad Lockdown Spine infrastructure.

Generated: $(date -u +%Y-%m-%dT%H:%M:%S.%3NZ) 