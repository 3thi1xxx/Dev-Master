<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fast Meme Trading Dashboard - Real-Time</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #e0e0e0;
            overflow-x: hidden;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 300px;
            grid-template-rows: 60px 1fr;
            height: 100vh;
            gap: 1px;
            background: #1a1a1a;
        }
        
        .header {
            grid-column: 1 / -1;
            background: #1a1a1a;
            border-bottom: 2px solid #00ff88;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #00ff88, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .status {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff88;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .main-content {
            background: #0a0a0a;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: auto 250px 1fr;
            gap: 20px;
        }
        
        .stats-grid {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
        }
        
        .stat-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            border-color: #00ff88;
            transform: translateY(-2px);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
        }
        
        .stat-change {
            font-size: 14px;
            margin-top: 5px;
        }
        
        .positive { color: #00ff88; }
        .negative { color: #ff4444; }
        .neutral { color: #ffaa00; }
        
        /* Enhanced Charts Layout */
        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .chart-container {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            height: 250px;
            overflow: hidden; /* Prevent chart overflow */
        }
        
        .surge-list, .hot-tokens-list {
            max-height: 180px;
            overflow-y: auto;
            padding: 10px 0;
        }
        
        .surge-item, .hot-token-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 4px 0;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 6px;
            border-left: 3px solid #00ff88;
            transition: background 0.2s;
        }
        
        .surge-item:hover, .hot-token-item:hover {
            background: rgba(0, 255, 136, 0.2);
        }
        
        .token-symbol {
            font-weight: 600;
            color: #00ffff;
        }
        
        .token-metrics {
            display: flex;
            gap: 10px;
            font-size: 0.85rem;
            color: #94a3b8;
        }
        
        .chart-title {
            font-size: 16px;
            margin-bottom: 15px;
            color: #fff;
        }
        
        .opportunities-container {
            grid-column: 1 / -1;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .opportunity-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .opportunity-card {
            background: #0f0f0f;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 15px;
            align-items: center;
            transition: all 0.3s;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .opportunity-card.high-score {
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }
        
        .opportunity-score {
            font-size: 32px;
            font-weight: bold;
            text-align: center;
        }
        
        .opportunity-details {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .opportunity-symbol {
            font-size: 18px;
            font-weight: bold;
        }
        
        .opportunity-metrics {
            display: flex;
            gap: 15px;
            font-size: 14px;
        }
        
        .opportunity-action {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }
        
        .recommendation {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .recommendation.buy {
            background: #00ff88;
            color: #000;
        }
        
        .recommendation.watch {
            background: #ffaa00;
            color: #000;
        }
        
        .recommendation.skip {
            background: #666;
            color: #fff;
        }
        
        .sidebar {
            background: #0a0a0a;
            border-left: 1px solid #333;
            padding: 20px;
            overflow-y: auto;
        }
        
        .live-feed {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .feed-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .live-indicator {
            width: 10px;
            height: 10px;
            background: #ff0000;
            border-radius: 50%;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .feed-item {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 10px;
            font-size: 13px;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .feed-time {
            font-size: 11px;
            color: #666;
        }
        
        .momentum-tracker {
            margin-top: 30px;
        }
        
        .momentum-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .momentum-bar {
            width: 100px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .momentum-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ffaa00, #00ff88);
            transition: width 0.3s ease;
        }
        
        .alert-banner {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: #00ff88;
            color: #000;
            padding: 15px 30px;
            border-radius: 30px;
            font-weight: bold;
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.5);
            animation: alertPop 0.5s ease-out;
            z-index: 1000;
        }
        
        /* Hot Tokens Styles */
        .hot-token-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: rgba(255, 136, 0, 0.1);
            border-left: 3px solid #ff8800;
            border-radius: 4px;
        }
        
        .token-symbol {
            font-weight: bold;
            color: #fff;
        }
        
        .token-change.positive {
            color: #00ff88;
        }
        
        .token-change.negative {
            color: #ff4444;
        }
        
        .token-volume {
            color: #94a3b8;
            font-size: 12px;
        }
        
        /* Surge Opportunities Styles */
        .surge-item {
            padding: 12px;
            margin: 8px 0;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 136, 0, 0.1));
            border-left: 3px solid #ffd700;
            border-radius: 4px;
        }
        
        .surge-token {
            font-weight: bold;
            font-size: 16px;
            color: #ffd700;
            margin-bottom: 5px;
        }
        
        .surge-metrics {
            display: flex;
            gap: 15px;
            font-size: 12px;
            color: #94a3b8;
        }
        
        .surge-metrics span:first-child {
            color: #00ff88;
            font-weight: bold;
        }
        
        .no-data {
            text-align: center;
            color: #64748b;
            padding: 20px;
            font-style: italic;
        }
        
        @keyframes alertPop {
            from {
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
        
        .performance-grid {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        
        .performance-card {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #222;
        }
        
        .metric-row:last-child {
            border-bottom: none;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #333;
            border-top-color: #00ff88;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }        
        /* Learning Metrics Panel */
        .learning-panel {
            background: rgba(26, 26, 26, 0.95);
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .metric-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #444;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #00ff88;
            margin-bottom: 5px;
        }
        
        .metric-label {
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        /* Enhanced Data Sections Styles */
        .market-stats-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .market-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .market-stat {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .market-stat .stat-label {
            color: #888;
            font-size: 12px;
        }
        
        .market-stat .stat-value {
            color: #fff;
            font-size: 16px;
            font-weight: bold;
        }
        
        .token-discovery-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .discovery-info {
            margin-bottom: 15px;
            color: #888;
        }
        
        .discovery-info #token-count {
            color: #00ff88;
            font-weight: bold;
        }
        
        .token-list {
            max-height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .token-discovered {
            background: #0f0f0f;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }
        
        .token-discovered .token-address {
            color: #00ff88;
            font-family: monospace;
            font-size: 11px;
        }
        
        .token-discovered a {
            color: #00ffff;
            text-decoration: none;
            margin-left: 10px;
        }
        
        .token-discovered a:hover {
            text-decoration: underline;
        }
        
        .transaction-feed-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 20px;
        }
        
        .tx-stats {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .buy-count {
            color: #00ff88;
        }
        
        .sell-count {
            color: #ff4444;
        }
        
        .tx-feed {
            max-height: 300px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .tx-buy, .tx-sell {
            padding: 8px;
            border-radius: 6px;
            display: grid;
            grid-template-columns: 60px 100px 100px 100px 1fr;
            gap: 10px;
            font-size: 12px;
            align-items: center;
        }
        
        .tx-buy {
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid #00ff88;
        }
        
        .tx-sell {
            background: rgba(255, 68, 68, 0.1);
            border-left: 3px solid #ff4444;
        }
        
        .tx-type {
            font-weight: bold;
        }
        
        .tx-token {
            color: #fff;
        }
        
        .tx-price {
            color: #888;
        }
        
        .tx-value {
            color: #00ffff;
        }
        
        .tx-time {
            color: #666;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <header class="header">
            <div class="logo">‚ö° Fast Meme Trading</div>
            <div class="status">
                <div class="status-item">
                    <div class="status-indicator"></div>
                    <span id="connectionStatus">Connected</span>
                </div>
                <div class="status-item">
                    <span id="analysisSpeed">0ms avg</span>
                </div>
                <div class="status-item">
                    <span id="currentTime">00:00:00</span>
                </div>
            </div>
        </header>
        
        <main class="main-content">
            <!-- Enhanced Stats Grid (Merged from both dashboards) -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Portfolio Value</div>
                    <div class="stat-value" id="portfolioValue">$10,000</div>
                    <div class="stat-change positive" id="portfolioChange">+0.00%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Daily P&L</div>
                    <div class="stat-value" id="dailyPnL">$0</div>
                    <div class="stat-change neutral" id="dailyPnLChange">0.00%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Auckland Latency</div>
                    <div class="stat-value" id="aucklandLatency">254ms</div>
                    <div class="stat-change positive">6.5x FASTER</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Opportunities</div>
                    <div class="stat-value positive" id="opportunities">0</div>
                    <div class="stat-change">Live tracking</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Win Rate</div>
                    <div class="stat-value" id="winRate">0%</div>
                    <div class="stat-change">Paper trades</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Strategies</div>
                    <div class="stat-value" id="activeStrategies">3</div>
                    <div class="stat-change">Running</div>
                </div>
            </div>
            
            <!-- NEW: Whale Discovery Panel -->
            <div class="control-panel whale-discovery">
                <h3 class="panel-title">üîç Whale Discovery & Tracking</h3>
                <div class="discovery-controls">
                    <button class="discover-btn" onclick="discoverProfitableWhales()" id="discoverBtn">
                        üîç DISCOVER PROFITABLE WHALES
                    </button>
                    <div class="discovery-status" id="discoveryStatus">
                        Ready to scan top traders...
                    </div>
                </div>
                <div class="discovery-results" id="whaleResults">
                    <!-- Live whale discovery results will appear here -->
                </div>
                <div class="auto-add-controls">
                    <label class="checkbox-label">
                        <input type="checkbox" id="autoAddWhales" checked>
                        Auto-add whales with >70% win rate
                    </label>
                    <span class="whale-count">Tracking: <span id="trackedWhaleCount">29</span> wallets</span>
                </div>
            </div>
            
            <!-- NEW: Filter Control Panel -->
            <div class="control-panel filter-controls">
                <h3 class="panel-title">üéõÔ∏è Trading Parameters</h3>
                <div class="sliders-grid">
                    <div class="slider-group">
                        <label>Min Liquidity: $<span id="liquidityValue">500</span></label>
                        <input type="range" min="100" max="5000" value="500" id="minLiquidity" 
                               oninput="updateSliderValue('liquidity', this.value)">
                    </div>
                    
                    <div class="slider-group">
                        <label>Min Volume (1m): $<span id="volumeValue">100</span></label>
                        <input type="range" min="50" max="1000" value="100" id="minVolume"
                               oninput="updateSliderValue('volume', this.value)">
                    </div>
                    
                    <div class="slider-group">
                        <label>Min Price Gain: <span id="priceGainValue">0.1</span>%</label>
                        <input type="range" min="0.1" max="5.0" step="0.1" value="0.1" id="minPriceGain"
                               oninput="updateSliderValue('priceGain', this.value)">
                    </div>
                    
                    <div class="slider-group">
                        <label>Buy/Sell Ratio: <span id="buyRatioValue">1.0</span>:1</label>
                        <input type="range" min="0.5" max="3.0" step="0.1" value="1.0" id="minBuyRatio"
                               oninput="updateSliderValue('buyRatio', this.value)">
                    </div>
                    
                    <div class="slider-group">
                        <label>Whale Entry: $<span id="whaleEntryValue">200</span></label>
                        <input type="range" min="100" max="1000" step="50" value="200" id="whaleEntrySize"
                               oninput="updateSliderValue('whaleEntry', this.value)">
                    </div>
                    
                    <div class="slider-group">
                        <label>Momentum Weight: <span id="momentumValue">40</span>%</label>
                        <input type="range" min="10" max="60" value="40" id="momentumWeight"
                               oninput="updateSliderValue('momentum', this.value)">
                    </div>
                </div>
                
                <div class="apply-controls">
                    <button class="apply-btn" onclick="applyFiltersAndRestart()" id="applyBtn">
                        üöÄ APPLY & RESTART SYSTEM
                    </button>
                    <div class="apply-status" id="applyStatus">
                        Current settings active
                    </div>
                </div>
            </div>
            
            <!-- NEW: Enhanced Market Statistics -->
            <div class="control-panel market-stats-panel">
                <h3 class="panel-title">üìä Market Statistics</h3>
                <div class="market-stats-grid">
                    <div class="market-stat">
                        <span class="stat-label">SOL Price:</span>
                        <span class="stat-value" id="sol-price">$--</span>
                    </div>
                    <div class="market-stat">
                        <span class="stat-label">Priority Fee:</span>
                        <span class="stat-value" id="priority-fee">-- SOL</span>
                    </div>
                    <div class="market-stat">
                        <span class="stat-label">24h Volume:</span>
                        <span class="stat-value" id="market-volume">$--</span>
                    </div>
                    <div class="market-stat">
                        <span class="stat-label">Volume Change:</span>
                        <span class="stat-value" id="market-change">--%</span>
                    </div>
                    <div class="market-stat">
                        <span class="stat-label">Hot Protocol:</span>
                        <span class="stat-value" id="hot-protocol">--</span>
                    </div>
                    <div class="market-stat">
                        <span class="stat-label">New Tokens:</span>
                        <span class="stat-value" id="new-tokens">--</span>
                    </div>
                </div>
            </div>
            
            <!-- NEW: Token Discovery Feed -->
            <div class="control-panel token-discovery-panel">
                <h3 class="panel-title">üéØ Token Discovery (Address Extraction)</h3>
                <div class="discovery-info">
                    <span>Tokens with extracted addresses: </span>
                    <span id="token-count">0</span>
                </div>
                <div id="discovered-tokens" class="token-list">
                    <!-- Token discoveries will appear here -->
                </div>
            </div>
            
            <!-- NEW: Live Transaction Feed -->
            <div class="control-panel transaction-feed-panel">
                <h3 class="panel-title">üí± Live Transactions</h3>
                <div class="tx-stats">
                    <span class="buy-count">Buys: <span id="buy-count">0</span></span>
                    <span class="sell-count">Sells: <span id="sell-count">0</span></span>
                </div>
                <div id="transaction-feed" class="tx-feed">
                    <!-- Live transactions will appear here -->
                </div>
            </div>
            
            <!-- Enhanced Charts Grid -->
            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">üìà Price Chart (Real-Time)</h3>
                    <canvas id="priceChart" height="180"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">üìä Score Distribution</h3>
                    <canvas id="scoreChart" height="180"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">‚ö° Surge Opportunities</h3>
                    <div id="surgeList" class="surge-list">
                        <!-- Live surge opportunities -->
                    </div>
                </div>
                
                <div class="chart-container">
                    <h3 class="chart-title">üî• Hot Tokens</h3>
                    <div id="hotTokens" class="hot-tokens-list">
                        <!-- Hot tokens from momentum -->
                    </div>
                </div>
            </div>
            
            <!-- Opportunities -->
            <div class="opportunities-container">
                <h3 class="chart-title">üéØ Live Opportunities</h3>
                <div class="opportunity-list" id="opportunityList">
                    <!-- Opportunities will be added here -->
                </div>
            </div>
            
            <!-- NEW: Learning Metrics (from realtime dashboard) -->
            <div class="learning-panel">
                <h3 class="panel-title">üß† AI Learning Metrics</h3>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="patternsDetected">0</div>
                        <div class="metric-label">Patterns Detected</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="confidenceScore">0%</div>
                        <div class="metric-label">AI Confidence</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="tradesExecuted">0</div>
                        <div class="metric-label">Trades Today</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="sharpeRatio">0.0</div>
                        <div class="metric-label">Sharpe Ratio</div>
                    </div>
                </div>
            </div>
        </main>
        
        <aside class="sidebar">
            <!-- Live Feed -->
            <div class="feed-title">
                <div class="live-indicator"></div>
                Live Feed
            </div>
            <div class="live-feed" id="liveFeed">
                <!-- Feed items will be added here -->
            </div>
            
            <!-- Momentum Tracker -->
            <div class="momentum-tracker">
                <div class="feed-title">üìà Momentum Tracker</div>
                <div id="momentumTracker">
                    <!-- Momentum items will be added here -->
                </div>
            </div>
        </aside>
    </div>
    
    <script>
        // Socket.IO connection
        const socket = io();
        
        // Chart contexts
        const priceCtx = document.getElementById('priceChart').getContext('2d');
        const scoreCtx = document.getElementById('scoreChart').getContext('2d');
        
        // Data storage
        const momentumData = {
            labels: [],
            datasets: [{
                label: 'Momentum Score',
                data: [],
                borderColor: '#00ff88',
                backgroundColor: 'rgba(0, 255, 136, 0.1)',
                tension: 0.4
            }]
        };
        
        const scoreData = {
            labels: ['0-20', '20-40', '40-60', '60-80', '80-100'],
            datasets: [{
                label: 'Token Distribution',
                data: [0, 0, 0, 0, 0],
                backgroundColor: ['#ff4444', '#ff8844', '#ffaa00', '#88ff00', '#00ff88']
            }]
        };
        
        // Initialize charts
        const priceChart = new Chart(priceCtx, {
            type: 'line',
            data: momentumData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        grid: { color: '#333' },
                        ticks: { color: '#888' }
                    },
                    x: {
                        grid: { color: '#333' },
                        ticks: { color: '#888' }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });
        
        const scoreChart = new Chart(scoreCtx, {
            type: 'bar',
            data: scoreData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#333' },
                        ticks: { color: '#888' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#888' }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });
        
        // Update time
        setInterval(() => {
            document.getElementById('currentTime').textContent = new Date().toLocaleTimeString();
        }, 1000);
        
        // Socket event handlers
        socket.on('connect', () => {
            console.log('Connected to server');
            addFeedItem('System connected', 'success');
        });
        
        socket.on('live-opportunity', (opportunity) => {
            addOpportunity(opportunity);
            updateStats(opportunity);
            
            // Show alert for high-score opportunities
            if (opportunity.analysis.scores?.overall >= 70) {
                showAlert(`üöÄ HIGH SCORE: ${opportunity.token.symbol} - ${opportunity.analysis.scores.overall}/100`);
            }
        });
        
        socket.on('momentum-update', (data) => {
            updatePriceChart(data);
            updateMomentumTracker(data);
        });
        
        socket.on('price-update', (data) => {
            updatePriceChart(data);
        });
        
        socket.on('stats-update', (stats) => {
            updateDashboardStats(stats);
        });
        
        // NEW: Enhanced Data Event Listeners
        
        // SOL Price updates
        socket.on('sol-price', (price) => {
            const element = document.getElementById('sol-price');
            if (element) {
                element.textContent = `$${price.toFixed(2)}`;
            }
        });
        
        // Priority fee updates
        socket.on('priority-fee', (fee) => {
            const element = document.getElementById('priority-fee');
            if (element) {
                element.textContent = `${fee.toFixed(6)} SOL`;
            }
        });
        
        // Market statistics
        socket.on('market-update', (stats) => {
            if (stats.overall) {
                const volumeEl = document.getElementById('market-volume');
                if (volumeEl) {
                    volumeEl.textContent = `$${(stats.overall.totalVolume / 1000000).toFixed(1)}M`;
                }
                
                const changeEl = document.getElementById('market-change');
                if (changeEl) {
                    const change = stats.overall.totalVolumePct || 0;
                    changeEl.textContent = `${change > 0 ? '+' : ''}${change.toFixed(1)}%`;
                    changeEl.style.color = change > 0 ? '#00ff88' : '#ff4444';
                }
                
                const tokensEl = document.getElementById('new-tokens');
                if (tokensEl) {
                    tokensEl.textContent = stats.overall.tokensCreated || '0';
                }
            }
            
            if (stats.hottestProtocol) {
                const protocolEl = document.getElementById('hot-protocol');
                if (protocolEl) {
                    protocolEl.textContent = stats.hottestProtocol.protocol || '--';
                }
            }
        });
        
        // Token discovery with addresses
        socket.on('token-discovered', (data) => {
            const countEl = document.getElementById('token-count');
            const tokensEl = document.getElementById('discovered-tokens');
            
            if (countEl) {
                const currentCount = parseInt(countEl.textContent) || 0;
                countEl.textContent = currentCount + 1;
            }
            
            if (tokensEl && data.tokenAddress) {
                const tokenElement = document.createElement('div');
                tokenElement.className = 'token-discovered';
                tokenElement.innerHTML = `
                    <span class="token-address">${data.tokenAddress.slice(0, 20)}...</span>
                    <div>
                        <a href="https://birdeye.so/token/${data.tokenAddress}" target="_blank">Birdeye</a>
                        <a href="https://dexscreener.com/solana/${data.tokenAddress}" target="_blank">DexScreener</a>
                    </div>
                `;
                
                tokensEl.insertBefore(tokenElement, tokensEl.firstChild);
                
                // Keep only last 10 tokens
                while (tokensEl.children.length > 10) {
                    tokensEl.removeChild(tokensEl.lastChild);
                }
                
                // Show notification
                addToFeed(`üéØ Token discovered: ${data.tokenAddress.slice(0, 8)}...`);
            }
        });
        
        // Live transactions
        let buyCount = 0;
        let sellCount = 0;
        
        socket.on('live-transaction', (tx) => {
            const feedEl = document.getElementById('transaction-feed');
            
            if (tx.type === 'buy') {
                buyCount++;
                const buyCountEl = document.getElementById('buy-count');
                if (buyCountEl) buyCountEl.textContent = buyCount;
            } else {
                sellCount++;
                const sellCountEl = document.getElementById('sell-count');
                if (sellCountEl) sellCountEl.textContent = sellCount;
            }
            
            if (feedEl && tx.token) {
                const txElement = document.createElement('div');
                txElement.className = tx.type === 'buy' ? 'tx-buy' : 'tx-sell';
                txElement.innerHTML = `
                    <span class="tx-type">${tx.type.toUpperCase()}</span>
                    <span class="tx-token">${tx.token.symbol || tx.token.address?.slice(0, 8) || 'Unknown'}</span>
                    <span class="tx-price">$${tx.token.priceUsd?.toFixed(6) || '0'}</span>
                    <span class="tx-value">$${tx.usdValue?.toFixed(2) || '0'}</span>
                    <span class="tx-time">${new Date(tx.timestamp).toLocaleTimeString()}</span>
                `;
                
                feedEl.insertBefore(txElement, feedEl.firstChild);
                
                // Keep only last 50 transactions
                while (feedEl.children.length > 50) {
                    feedEl.removeChild(feedEl.lastChild);
                }
            }
        });
        
        // Hot opportunities from enhanced processor
        socket.on('hot-opportunity', (data) => {
            if (data.token) {
                showAlert(`üî• HOT: ${data.token.symbol || data.token.address?.slice(0, 8)} - Liq: ${data.token.liquidity?.toFixed(1)} SOL`);
            }
        });
        
        // Trading opportunities
        socket.on('feed-update', (update) => {
            addFeedItem(update.message || update.content, update.type);
        });
        
        // NEW: Handle real-time data from WebSocket Data Bridge
        socket.on('hot-tokens-update', (tokens) => {
            updateHotTokensList(tokens);
        });
        
        socket.on('surge-opportunity', (opportunity) => {
            addSurgeOpportunity(opportunity);
        });
        
        socket.on('whale-activity', (activity) => {
            addFeedItem(`üêã Whale ${activity.action}: ${activity.token} - $${activity.value}`, 'whale');
        });
        
        socket.on('whale-buy-signal', (signal) => {
            showAlert(`üêã WHALE BUY: ${signal.token} - $${signal.amount} (${Math.round(signal.confidence * 100)}% confidence)`);
        });
        
        socket.on('token-enriched-data', (data) => {
            // Update any displayed token with enriched data
            updateTokenDisplay(data);
        });
        
        socket.on('whale-discovered', (discovery) => {
            if (discovery.winRate > 0.7) {
                addFeedItem(`üéØ New profitable whale: ${discovery.winRate * 100}% win rate`, 'success');
                updateTrackedWhaleCount();
            }
        });
        
        // Functions
        function addOpportunity(opportunity) {
            const list = document.getElementById('opportunityList');
            const score = opportunity.analysis.scores?.overall || 0;
            const isHighScore = score >= 70;
            
            const card = document.createElement('div');
            card.className = `opportunity-card ${isHighScore ? 'high-score' : ''}`;
            
            card.innerHTML = `
                <div class="opportunity-score ${getScoreClass(score)}">${score}</div>
                <div class="opportunity-details">
                    <div class="opportunity-symbol">${opportunity.token.symbol}</div>
                    <div class="opportunity-metrics">
                        <span>üíß $${formatNumber(opportunity.token.liquidity)}</span>
                        <span>üìà ${opportunity.analysis.scores?.momentum || 0}</span>
                        <span>üêã ${opportunity.analysis.scores?.whale || 0}</span>
                        <span>‚ö° ${opportunity.analysisTime || 0}ms</span>
                    </div>
                </div>
                <div class="opportunity-action">
                    <div class="recommendation ${getRecommendationClass(opportunity.analysis.recommendation?.action)}">
                        ${opportunity.analysis.recommendation?.action || 'SKIP'}
                    </div>
                    <div style="font-size: 12px; color: #888;">
                        ${Math.round((opportunity.analysis.confidence || 0) * 100)}% confidence
                    </div>
                </div>
            `;
            
            list.insertBefore(card, list.firstChild);
            
            // Keep only last 20 opportunities
            while (list.children.length > 20) {
                list.removeChild(list.lastChild);
            }
            
            // Update score distribution
            updateScoreDistribution(score);
        }
        
        function updateMomentumChart(data) {
            if (momentumData.labels.length > 50) {
                momentumData.labels.shift();
                momentumData.datasets[0].data.shift();
            }
            
            momentumData.labels.push(new Date().toLocaleTimeString());
            momentumData.datasets[0].data.push(data.momentum || 0);
            priceChart.update();
        }
        
        function updatePriceChart(data) {
            // Update price chart with real-time data
            if (momentumData.labels.length > 50) {
                momentumData.labels.shift();
                momentumData.datasets[0].data.shift();
            }
            
            const price = data.price || data.momentum || 0;
            momentumData.labels.push(new Date().toLocaleTimeString());
            momentumData.datasets[0].data.push(price);
            priceChart.update('none'); // No animation for performance
        }
        
        function updateMomentumTracker(data) {
            const tracker = document.getElementById('momentumTracker');
            
            // Clear existing items
            tracker.innerHTML = '';
            
            // Add top 5 momentum tokens
            if (data.tokens) {
                data.tokens.slice(0, 5).forEach(token => {
                    const item = document.createElement('div');
                    item.className = 'momentum-item';
                    
                    const momentum = Math.min(100, Math.max(0, token.momentum));
                    
                    item.innerHTML = `
                        <span>${token.symbol}</span>
                        <div class="momentum-bar">
                            <div class="momentum-fill" style="width: ${momentum}%"></div>
                        </div>
                        <span>${momentum.toFixed(0)}%</span>
                    `;
                    
                    tracker.appendChild(item);
                });
            }
        }
        
        function updateScoreDistribution(score) {
            const index = Math.floor(score / 20);
            if (index >= 0 && index < 5) {
                // Prevent infinite growth - reset chart when data gets too high
                if (scoreData.datasets[0].data[index] > 30) {
                    console.log('üìä Resetting score distribution chart');
                    scoreData.datasets[0].data = [0, 0, 0, 0, 0];
                }
                
                scoreData.datasets[0].data[index]++;
                scoreChart.update('none'); // No animation for better performance
            }
        }
        
        function addFeedItem(message, type = 'info') {
            const feed = document.getElementById('liveFeed');
            const item = document.createElement('div');
            item.className = 'feed-item';
            
            const time = new Date().toLocaleTimeString();
            item.innerHTML = `
                <div class="feed-time">${time}</div>
                <div>${message}</div>
            `;
            
            feed.insertBefore(item, feed.firstChild);
            
            // Keep only last 50 items
            while (feed.children.length > 50) {
                feed.removeChild(feed.lastChild);
            }
        }
        
        function updateStats(opportunity) {
            // Update stats based on new opportunity
            const opportunitiesElement = document.getElementById('opportunities');
            if (opportunitiesElement) {
                const currentCount = parseInt(opportunitiesElement.textContent) || 0;
                opportunitiesElement.textContent = currentCount + 1;
            }
        }
        
        function updateDashboardStats(stats) {
            // Update all stat cards - safely check if elements exist
            if (stats.tokensPerHour !== undefined) {
                const element = document.getElementById('tokensPerHour');
                if (element) element.textContent = stats.tokensPerHour;
            }
            if (stats.hitRate !== undefined) {
                const element = document.getElementById('hitRate');
                if (element) element.textContent = stats.hitRate + '%';
            }
            if (stats.opportunities !== undefined) {
                const element = document.getElementById('opportunities');
                if (element) element.textContent = stats.opportunities;
            }
            if (stats.avgScore !== undefined) {
                const element = document.getElementById('avgScore');
                if (element) element.textContent = stats.avgScore;
            }
            if (stats.winRate !== undefined) {
                const element = document.getElementById('winRate');
                if (element) element.textContent = stats.winRate + '%';
            }
            if (stats.profitLoss !== undefined) {
                const plElement = document.getElementById('profitLoss');
                if (plElement) {
                    plElement.textContent = '$' + formatNumber(stats.profitLoss);
                    plElement.className = stats.profitLoss >= 0 ? 'stat-value positive' : 'stat-value negative';
                }
            }
            if (stats.analysisSpeed !== undefined) {
                const element = document.getElementById('analysisSpeed');
                if (element) element.textContent = stats.analysisSpeed + 'ms avg';
            }
        }
        
        function showAlert(message) {
            const alert = document.createElement('div');
            alert.className = 'alert-banner';
            alert.textContent = message;
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }
        
        function getScoreClass(score) {
            if (score >= 80) return 'positive';
            if (score >= 60) return 'neutral';
            return 'negative';
        }
        
        function getRecommendationClass(action) {
            switch(action) {
                case 'BUY':
                case 'STRONG_BUY':
                    return 'buy';
                case 'WATCH':
                    return 'watch';
                default:
                    return 'skip';
            }
        }
        
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toFixed(0);
        }
        
        // Add missing slider update function
        function updateSliderValue(type, value) {
            const elements = {
                'liquidity': 'liquidityValue',
                'volume': 'volumeValue',
                'priceGain': 'priceGainValue',
                'buyRatio': 'buyRatioValue',
                'whaleEntry': 'whaleEntryValue',
                'momentum': 'momentumValue'
            };
            
            const element = document.getElementById(elements[type]);
            if (element) {
                element.textContent = value;
            }
        }
        
        // Add missing apply filters function
        function applyFiltersAndRestart() {
            const applyBtn = document.getElementById('applyBtn');
            const applyStatus = document.getElementById('applyStatus');
            
            if (applyBtn) {
                applyBtn.disabled = true;
                applyBtn.textContent = 'Applying...';
            }
            
            if (applyStatus) {
                applyStatus.textContent = 'Restarting with new settings...';
            }
            
            // Send new settings to server
            socket.emit('update-parameters', {
                liquidity: document.getElementById('minLiquidity')?.value,
                volume: document.getElementById('minVolume')?.value,
                priceGain: document.getElementById('minPriceGain')?.value,
                buyRatio: document.getElementById('minBuyRatio')?.value,
                whaleEntry: document.getElementById('whaleEntrySize')?.value,
                momentum: document.getElementById('momentumWeight')?.value
            });
            
            setTimeout(() => {
                if (applyBtn) {
                    applyBtn.disabled = false;
                    applyBtn.textContent = 'üöÄ APPLY & RESTART SYSTEM';
                }
                if (applyStatus) {
                    applyStatus.textContent = 'New settings applied';
                }
            }, 2000);
        }
        
        // NEW: Whale Discovery Functions
        async function discoverProfitableWhales() {
            const discoverBtn = document.getElementById('discoverBtn');
            const discoveryStatus = document.getElementById('discoveryStatus');
            const whaleResults = document.getElementById('whaleResults');
            
            try {
                discoverBtn.disabled = true;
                discoverBtn.textContent = 'üîç SCANNING...';
                discoveryStatus.textContent = 'Fetching top traders from Birdeye...';
                
                whaleResults.innerHTML = '<div style="text-align: center; padding: 20px; color: #94a3b8;">Scanning profitable traders...</div>';
                
                const response = await fetch('/api/discover-whales', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ minWinRate: 0.7, timeFrame: '24h', limit: 20 })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayWhaleResults(data.whales);
                    discoveryStatus.textContent = `Found ${data.whales.length} profitable whales`;
                } else {
                    discoveryStatus.textContent = `Error: ${data.error}`;
                }
                
            } catch (error) {
                console.error('Whale discovery error:', error);
                discoveryStatus.textContent = 'Discovery failed - check connection';
            } finally {
                discoverBtn.disabled = false;
                discoverBtn.textContent = 'üîç DISCOVER PROFITABLE WHALES';
            }
        }
        
        function displayWhaleResults(whales) {
            const whaleResults = document.getElementById('whaleResults');
            const autoAdd = document.getElementById('autoAddWhales').checked;
            
            if (whales.length === 0) {
                whaleResults.innerHTML = '<div style="text-align: center; padding: 20px; color: #94a3b8;">No profitable whales found</div>';
                return;
            }
            
            whaleResults.innerHTML = whales.map(whale => `
                <div class="whale-result" data-address="${whale.address}">
                    <div>
                        <div class="whale-address">${whale.address.slice(0, 8)}...${whale.address.slice(-6)}</div>
                        <div class="whale-metrics">
                            <span>Win: ${whale.winRate}%</span>
                            <span>P&L: $${whale.pnl24h}</span>
                            <span>Vol: $${formatNumber(whale.volume24h)}</span>
                        </div>
                    </div>
                    <button class="add-whale-btn" onclick="addWhaleToTracking('${whale.address}', ${whale.winRate})">
                        ${autoAdd && whale.winRate > 70 ? '‚úÖ ADDED' : '+ ADD'}
                    </button>
                </div>
            `).join('');
            
            if (autoAdd) {
                whales.filter(w => w.winRate > 70).forEach(whale => {
                    setTimeout(() => addWhaleToTracking(whale.address, whale.winRate), 500);
                });
            }
        }
        
        async function addWhaleToTracking(address, winRate) {
            try {
                const response = await fetch('/api/whales/track', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ address, winRate })
                });
                
                const data = await response.json();
                if (data.success) {
                    updateTrackedWhaleCount();
                    showAlert(`üêã Added whale: ${address.slice(0, 8)}... (${winRate}% win rate)`);
                }
            } catch (error) {
                console.error('Failed to add whale:', error);
            }
        }
        
        function updateTrackedWhaleCount() {
            const countElement = document.getElementById('trackedWhaleCount');
            if (countElement) {
                const currentCount = parseInt(countElement.textContent) || 29;
                countElement.textContent = currentCount + 1;
            }
        }
        
        // NEW: Update hot tokens list
        function updateHotTokensList(tokens) {
            const hotTokensDiv = document.getElementById('hotTokens');
            if (!hotTokensDiv) return;
            
            hotTokensDiv.innerHTML = tokens.slice(0, 5).map(token => `
                <div class="hot-token-item">
                    <span class="token-symbol">${token.symbol}</span>
                    <span class="token-change ${token.priceChange > 0 ? 'positive' : 'negative'}">
                        ${token.priceChange > 0 ? '+' : ''}${token.priceChange.toFixed(2)}%
                    </span>
                    <span class="token-volume">$${formatNumber(token.volume)}</span>
                </div>
            `).join('') || '<div class="no-data">No hot tokens detected</div>';
        }
        
        // NEW: Add surge opportunity
        function addSurgeOpportunity(opportunity) {
            const surgeList = document.getElementById('surgeList');
            if (!surgeList) return;
            
            const item = document.createElement('div');
            item.className = 'surge-item';
            item.innerHTML = `
                <div class="surge-token">${opportunity.symbol}</div>
                <div class="surge-metrics">
                    <span>+${opportunity.priceChange.toFixed(1)}%</span>
                    <span>$${formatNumber(opportunity.liquidity)}</span>
                    <span>${Math.round(opportunity.confidence * 100)}%</span>
                </div>
            `;
            
            surgeList.insertBefore(item, surgeList.firstChild);
            
            // Keep only last 5
            while (surgeList.children.length > 5) {
                surgeList.removeChild(surgeList.lastChild);
            }
        }
        
        // NEW: Update token display with enriched data
        function updateTokenDisplay(data) {
            // Update any opportunity cards showing this token
            const cards = document.querySelectorAll('.opportunity-card');
            cards.forEach(card => {
                const symbol = card.querySelector('.opportunity-symbol');
                if (symbol && symbol.textContent === data.symbol) {
                    // Update metrics with enriched data
                    const metrics = card.querySelector('.opportunity-metrics');
                    if (metrics) {
                        metrics.innerHTML = `
                            <span>üíß $${formatNumber(data.liquidity)}</span>
                            <span>üìä ${data.holders || 0}</span>
                            <span>üîÑ ${data.buySellRatio?.toFixed(2) || '1.0'}</span>
                            <span>üìà ${data.priceChange24h?.toFixed(1) || 0}%</span>
                        `;
                    }
                }
            });
        }
        
        // NEW: Filter Control Functions
        function updateSliderValue(type, value) {
            const displays = {
                'liquidity': 'liquidityValue',
                'volume': 'volumeValue', 
                'priceGain': 'priceGainValue',
                'buyRatio': 'buyRatioValue',
                'whaleEntry': 'whaleEntryValue',
                'momentum': 'momentumValue'
            };
            
            if (displays[type]) {
                document.getElementById(displays[type]).textContent = value;
            }
        }
        
        async function applyFiltersAndRestart() {
            const applyBtn = document.getElementById('applyBtn');
            const applyStatus = document.getElementById('applyStatus');
            
            try {
                applyBtn.disabled = true;
                applyBtn.textContent = 'üîÑ APPLYING...';
                applyStatus.textContent = 'Gathering filter values...';
                
                const filters = {
                    minLiquidity: document.getElementById('minLiquidity').value,
                    minVolume: document.getElementById('minVolume').value,
                    minPriceGain: document.getElementById('minPriceGain').value,
                    minBuyRatio: document.getElementById('minBuyRatio').value,
                    whaleEntrySize: document.getElementById('whaleEntrySize').value,
                    momentumWeight: document.getElementById('momentumWeight').value
                };
                
                applyStatus.textContent = 'Restarting system with new parameters...';
                
                const response = await fetch('/api/system/restart-with-filters', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ filters })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    applyStatus.textContent = 'New parameters active - system restarted';
                    showAlert('üöÄ System restarted with optimized filters!');
                    document.getElementById('opportunityList').innerHTML = '';
                } else {
                    applyStatus.textContent = `Restart failed: ${data.error}`;
                }
                
            } catch (error) {
                console.error('Filter apply error:', error);
                applyStatus.textContent = 'Apply failed - check connection';
            } finally {
                applyBtn.disabled = false;
                applyBtn.textContent = 'üöÄ APPLY & RESTART SYSTEM';
            }
        }
        
        function updateTrackedWhaleCount() {
            fetch('/api/whales/count')
                .then(r => r.json())
                .then(data => {
                    document.getElementById('trackedWhaleCount').textContent = data.count || '29';
                })
                .catch(() => {}); // Silent fail
        }
        
        // Enhanced portfolio updates (merged from realtime dashboard)
        socket.on('portfolio-update', (data) => {
            document.getElementById('portfolioValue').textContent = `$${formatNumber(data.totalValue)}`;
            document.getElementById('portfolioChange').textContent = `${data.dailyPnLPercent > 0 ? '+' : ''}${data.dailyPnLPercent.toFixed(2)}%`;
            document.getElementById('dailyPnL').textContent = `$${data.dailyPnL.toFixed(2)}`;
            document.getElementById('dailyPnLChange').textContent = `${data.dailyPnLPercent.toFixed(2)}%`;
            
            // Update change indicators
            const portfolioChange = document.getElementById('portfolioChange');
            const dailyChange = document.getElementById('dailyPnLChange');
            
            portfolioChange.className = data.dailyPnLPercent > 0 ? 'stat-change positive' : 
                                       data.dailyPnLPercent < 0 ? 'stat-change negative' : 'stat-change neutral';
            dailyChange.className = portfolioChange.className;
        });
        
        // NEW: Enhanced features from realtime dashboard
        socket.on('surge-opportunity', (surge) => {
            addSurgeOpportunity(surge);
        });
        
        socket.on('hot-token', (token) => {
            addHotToken(token);
        });
        
        function addSurgeOpportunity(surge) {
            const surgeList = document.getElementById('surgeList');
            const surgeItem = document.createElement('div');
            surgeItem.className = 'surge-item';
            surgeItem.innerHTML = `
                <div>
                    <div class="token-symbol">${surge.symbol}</div>
                    <div class="token-metrics">
                        <span>üìà ${surge.change}%</span>
                        <span>üí∞ $${formatNumber(surge.volume)}</span>
                    </div>
                </div>
                <div class="surge-score">${surge.score}/100</div>
            `;
            
            surgeList.insertBefore(surgeItem, surgeList.firstChild);
            
            // Keep only last 10 items
            while (surgeList.children.length > 10) {
                surgeList.removeChild(surgeList.lastChild);
            }
        }
        
        function addHotToken(token) {
            const hotTokens = document.getElementById('hotTokens');
            const tokenItem = document.createElement('div');
            tokenItem.className = 'hot-token-item';
            tokenItem.innerHTML = `
                <div>
                    <div class="token-symbol">${token.symbol}</div>
                    <div class="token-metrics">
                        <span>üî• ${token.momentum}</span>
                        <span>üë• ${token.holders}</span>
                    </div>
                </div>
                <div class="token-temp">${token.temperature}¬∞</div>
            `